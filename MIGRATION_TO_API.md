# Миграция на API - Замена тестовых данных

## Выполненные изменения

### 1. ✅ AuthService
- **Было:** Тестовые пользователи в AsyncStorage
- **Стало:** Полная интеграция с API бэкенда
- **Эндпоинты:**
  - `POST /api/auth` - регистрация
  - `GET /api/auth` - вход
  - `GET /api/auth/@me` - получение текущего пользователя

### 2. ✅ ObjectService
- **Было:** Тестовые объекты в AsyncStorage
- **Стало:** Полная интеграция с API бэкенда
- **Эндпоинты:**
  - `GET /api/objects` - список объектов
  - `GET /api/objects/:id` - получение объекта
  - `POST /api/objects` - создание объекта
  - `PUT /api/objects/:id` - обновление объекта
  - `DELETE /api/objects/:id` - удаление объекта

### 3. ✅ FireSafetyService (Огнетушители)
- **Было:** Тестовые огнетушители в AsyncStorage
- **Стало:** Полная интеграция с API бэкенда
- **Эндпоинты:**
  - `GET /api/extinguishers/objects/:objectId` - получение по объекту
  - `GET /api/extinguishers/:id` - получение по ID
  - `POST /api/extinguishers` - создание
  - `PUT /api/extinguishers/:id` - обновление
  - `DELETE /api/extinguishers/:id` - удаление

### 4. ✅ DataService
- **Было:** Прямая работа с AsyncStorage
- **Стало:** Прокси-сервис, использующий objectService и authService
- **Примечание:** Сохранен для обратной совместимости, но теперь использует API через другие сервисы

### 5. ⚠️ FireSafetyService (FireEquipment)
- **Статус:** Локальное хранилище (без тестовых данных)
- **Причина:** В бэкенде пока нет отдельного эндпоинта для FireEquipment
- **Действие:** При первом запуске возвращается пустой массив вместо тестовых данных
- **TODO:** Создать эндпоинты для FireEquipment в бэкенде

## Что изменилось для пользователя

1. **При первом запуске:**
   - Нет тестовых данных
   - Нужна регистрация/вход
   - Все данные загружаются с сервера

2. **Работа с данными:**
   - Все операции (создание, чтение, обновление, удаление) идут через API
   - Данные синхронизируются с сервером
   - Офлайн-режим не поддерживается (данные не кешируются локально)

3. **Обработка ошибок:**
   - Все ошибки API обрабатываются и показываются пользователю
   - При ошибках сети показываются понятные сообщения

## Оставшиеся задачи

### FireEquipment API
В бэкенде нужно создать эндпоинты для пожарного оборудования:
- `GET /api/equipment` - список всего оборудования
- `GET /api/equipment/objects/:objectId` - оборудование по объекту
- `GET /api/equipment/:id` - получение по ID
- `POST /api/equipment` - создание
- `PUT /api/equipment/:id` - обновление
- `DELETE /api/equipment/:id` - удаление

После создания этих эндпоинтов нужно обновить `fireSafetyService.ts` аналогично огнетушителям.

## Проверка работы

1. **Проверьте подключение к бэкенду:**
   - Убедитесь, что бэкенд запущен на порту 3001
   - Проверьте URL в `api.config.ts`

2. **Проверьте авторизацию:**
   - Зарегистрируйте нового пользователя
   - Войдите в систему
   - Проверьте, что данные загружаются с сервера

3. **Проверьте CRUD операции:**
   - Создайте объект
   - Обновите объект
   - Удалите объект
   - Проверьте, что изменения сохраняются на сервере

## Откат к тестовым данным

Если нужно временно вернуться к тестовым данным (для разработки без бэкенда), можно:

1. Временно закомментировать вызовы API
2. Вернуть работу с AsyncStorage
3. Добавить тестовые данные обратно

**Но это не рекомендуется** - лучше использовать реальный бэкенд даже в разработке.

